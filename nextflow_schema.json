{
    "$schema": "http://json-schema.org/draft-07/schema",
    "$id": "https://raw.githubusercontent.com/./master/nextflow_schema.json",
    "title": "epi2me-labs/wf-cas9",
    "description": "Summarise the results of Cas9 enrichment sequencing.",
    "demo_url": "https://ont-exd-int-s3-euwst1-epi2me-labs.s3.amazonaws.com/wf-cas9/wf-cas9-demo.tar.gz",
    "aws_demo_url": "https://ont-exd-int-s3-euwst1-epi2me-labs.s3.amazonaws.com/wf-cas9/wf-cas9-demo/aws.nextflow.config",
    "url": "https://github.com/epi2me-labs/wf-cas9",
    "type": "object",
    "definitions": {
        "input": {
            "title": "Input Options",
            "type": "object",
            "fa_icon": "fas fa-arrow-right",
            "description": "Parameters for finding and handling input data for analysis.",
            "properties": {
                "fastq": {
                    "type": "string",
                    "format": "path",
                    "description": "FASTQ files to use in the analysis.",
                    "help_text": "This accepts one of three cases: (i) the path to a single FASTQ file; (ii) the path to a top-level directory containing FASTQ files; (iii) the path to a directory containing one level of sub-directories which in turn contain FASTQ files. In the first and second case, a sample name can be supplied with `--sample`. In the last case, the data is assumed to be multiplexed with the names of the sub-directories as barcodes. In this case, a sample sheet can be provided with `--sample_sheet`."
                },
                "reference_genome": {
                    "type": "string",
                    "format": "file-path",
                    "description": "FASTA reference file.",
                    "help_text": "Full path to a FASTA reference genome file conating the target regions of interest."
                },
                "targets": {
                    "type": "string",
                    "format": "file-path",
                    "description": "A tab-delimited BED file of target regions.",
                    "help_text": "Each row should contain the following fields: chromosome/contig name, start and end of target region, and a name to identify the target. An example row would look like this: `chr19 13204400 13211100 SCA6`"
                },
                "analyse_unclassified": {
                    "type": "boolean",
                    "default": false,
                    "description": "Analyse unclassified reads from input directory. By default the workflow will not process reads in the unclassified directory.",
                    "help_text": "If selected and if the input is a multiplex directory the workflow will also process the unclassified directory."
                }
            },
            "required": [
                "fastq",
                "reference_genome",
                "targets"
            ]
        },
        "samples": {
            "title": "Sample Options",
            "type": "object",
            "fa_icon": "fas fa-vials",
            "description": "Parameters that relate to samples such as sample sheets and sample names.",
            "properties": {
                "sample_sheet": {
                    "type": "string",
                    "format": "file-path",
                    "description": "A CSV file used to map barcodes to sample aliases. The sample sheet can be provided when the input data is a directory containing sub-directories with FASTQ files.",
                    "help_text": "The sample sheet is a CSV file with, minimally, columns named `barcode` and `alias`. Extra columns are allowed. A `type` column is required for certain workflows and should have the following values; `test_sample`, `positive_control`, `negative_control`, `no_template_control`."
                },
                "sample": {
                    "type": "string",
                    "description": "A single sample name for non-multiplexed data. Permissible if passing a single .fastq(.gz) file or directory of .fastq(.gz) files."
                }
            }
        },
        "output": {
            "title": "Output Options",
            "type": "object",
            "fa_icon": "fas fa-arrow-left",
            "description": "Parameters for saving and naming workflow outputs.",
            "properties": {
                "out_dir": {
                    "type": "string",
                    "default": "output",
                    "format": "directory-path",
                    "description": "Directory for output of all workflow results."
                },
                "full_report": {
                    "type": "boolean",
                    "description": "Select this option to write a full report that contains plots giving a graphical representation of coverage at each target region.",
                    "help_text": "In cases where there are many target to visualise, the report loading time can be slow and so it's is recommended to set `full_report` to false in such cases.",
                    "default": false
                }
            }
        },
        "advanced_options": {
            "title": "Advanced Options",
            "type": "object",
            "fa_icon": "far fa-question-circle",
            "description": "Advanced options for configuring processes inside the workflow.",
            "help_text": "These advanced options do not need to be changed for typical use, but allow fine tuning of workflows for users who want more control over the workflow.",
            "properties": {
                "threads": {
                    "type": "integer",
                    "description": "Number of CPU threads to use per workflow task.",
                    "help_text": "The total CPU resource used by the workflow is constrained by the executor configuration.",
                    "default": 8
                },
                "minimap2_max_memory": {
                    "type": "string",
                    "default": "8 GB",
                    "description": "Maximum allowed memory usage for the minimap2 stage,",
                    "help_text": "The total memory resource used by the workflow is constrained by the executor configuration"
                }
            }
        },
        "misc": {
            "title": "Miscellaneous Options",
            "type": "object",
            "description": "Everything else.",
            "default": "",
            "properties": {
                "disable_ping": {
                    "type": "boolean",
                    "default": false,
                    "description": "Enable to prevent sending a workflow ping."
                },
                "help": {
                    "type": "boolean",
                    "description": "Display help text.",
                    "fa_icon": "fas fa-question-circle",
                    "hidden": true
                },
                "version": {
                    "type": "boolean",
                    "description": "Display version and exit.",
                    "fa_icon": "fas fa-question-circle",
                    "hidden": true
                }
            }
        }
    },
    "allOf": [
        {
            "$ref": "#/definitions/input"
        },
        {
            "$ref": "#/definitions/samples"
        },
        {
            "$ref": "#/definitions/output"
        },
        {
            "$ref": "#/definitions/advanced_options"
        },
        {
            "$ref": "#/definitions/misc"
        }
    ],
    "properties": {
        "process_label": {
            "type": "string",
            "description": "The main process label for template processes to use by default",
            "hidden": true,
            "default": "cas9"
        },
        "aws_image_prefix": {
            "type": "string",
            "hidden": true
        },
        "aws_queue": {
            "type": "string",
            "hidden": true
        },
        "monochrome_logs": {
            "type": "boolean"
        },
        "validate_params": {
            "type": "boolean",
            "default": true
        },
        "show_hidden_params": {
            "type": "boolean"
        }
    },
    "docs": {
        "intro": "## Introduction\nThe ONT Cas9 sequencing kit allows the enrichment of genomic\nregions of interest by amplifying target regions from adapters ligated to Cas9 cleavage sites.\nThe purpose of this workflow is to assess the effectiveness of such Cas9 enrichment, \nbut it can be applied to other enrichment approaches. The workflow outputs\nhelp assess the effectiveness \nof the enrichement strategy and can be used to diagnose issues such as poorly performing probes.\n\nInputs to the workflow are: a reference genome file, FASTQ reads from enrichment sequencing,\nand a BED file detailing the regions of interests (targets).\nThe main outputs are a report containing summary statistics and plots which give an overview of \nthe enrichment, and a BAM file with target-overlapping reads.\n\nThe main steps of the workflow are alignemnt of reads to the genome using \n[minimap2](https://github.com/lh3/minimap2) and the analaysis\nof read-target overlap with [bedtools](https://github.com/arq5x/bedtools2).\n\n\n\n\n",
        "links": "## Useful links\n\n* [nextflow](https://www.nextflow.io/)\n* [docker](https://www.docker.com/products/docker-desktop)\n* [singularity](https://docs.sylabs.io/guides/3.5/user-guide/introduction.html)"
    }
}